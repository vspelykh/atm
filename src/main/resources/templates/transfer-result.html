<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>Transfer result</title>
    <link rel="stylesheet" href="/css/styles.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="/js/scripts.js"></script>
</head>
<body>

<div id="resultContainer">

</div>
<script th:inline="javascript">

    var amount = /*[[${amount}]]*/ null;
    var accountTo = /*[[${accountTo}]]*/ null;
</script>

<script>
    $(document).ready(function () {
        $.ajax({
            url: '/api/transfer',
            type: 'POST',
            data: JSON.stringify({ accountTo: accountTo, amount: amount }),
            contentType: 'application/json',
            success: function (response) {
                console.log(amount);
                var resultContainer = $('#resultContainer');

                resultContainer.empty();

                var transferInfo = 'Transfer: ' + response.amount + ' grn, to: ' + response.destinationAccount.accountNumber;
                var transferElem = $('<div>').text(transferInfo);
                resultContainer.append(transferElem);
            },
            error: function (xhr, textStatus, errorThrown) {
                var resultContainer = $('#resultContainer');
                resultContainer.empty();

                if (xhr.status === 400) {
                    resultContainer.append("Error");
                } else {
                    // Обробка інших помилок
                }
            }
        });
    });
</script>
<br>
<div class="button-row">
    <button class="button" sec:authorize="isAuthenticated()">
        <a th:href="@{/logout}">Put off card</a>
    </button>
    <button class="button" sec:authorize="isAuthenticated()">
        <a th:href="@{/}">Main menu</a>
    </button>
</div>
</body>
</html>
